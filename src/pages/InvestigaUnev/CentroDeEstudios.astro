
---
// src/pages/centros-estudios.astro
import Layout from '../../layouts/Layout.astro'
export interface Props {
  title?: string;
}

const { title = "Centros de estudios - INTEC" } = Astro.props;

// Datos de centros de estudios
const centros = [
  {
    id: 1,
    titulo: "Centro de Capacitación e Investigación del Plástico",
    descripcion: "Centro especializado en investigación y desarrollo de tecnologías para la industria del plástico y materiales poliméricos.",
    area: "INGENIERÍA",
    estado: "ACTIVO",
    director: "Dr. María González",
    fundacion: "2015"
  },
  {
    id: 2,
    titulo: "Centro de Gestión Ambiental",
    descripcion: "Enfocado en estudios de sostenibilidad, cambio climático y desarrollo de soluciones ambientales innovadoras.",
    area: "CIENCIAS AMBIENTALES",
    estado: "ACTIVO",
    director: "Dr. Carlos Mendoza",
    fundacion: "2012"
  },
  {
    id: 3,
    titulo: "Centro de Estudios del Género",
    descripcion: "Investigación interdisciplinaria sobre temas de género, equidad y desarrollo social en la República Dominicana.",
    area: "CIENCIAS SOCIALES",
    estado: "ACTIVO",
    director: "Dra. Ana Rodríguez",
    fundacion: "2018"
  },
  {
    id: 4,
    titulo: "Centro de Emprendimiento e Innovación",
    descripcion: "Promueve la cultura emprendedora y la innovación tecnológica entre estudiantes y profesionales.",
    area: "INNOVACIÓN",
    estado: "ACTIVO",
    director: "Ing. Roberto Silva",
    fundacion: "2016"
  },
  {
    id: 5,
    titulo: "Centro de Estudios Urbanos y Territoriales",
    descripcion: "Investigación sobre desarrollo urbano sostenible, planificación territorial y ciudades inteligentes.",
    area: "ARQUITECTURA",
    estado: "ACTIVO",
    director: "Arq. Patricia Morales",
    fundacion: "2019"
  },
  {
    id: 6,
    titulo: "Centro de Investigación en Salud Pública",
    descripcion: "Estudios epidemiológicos, promoción de la salud y desarrollo de políticas sanitarias.",
    area: "CIENCIAS DE LA SALUD",
    estado: "ACTIVO",
    director: "Dr. Luis Fernández",
    fundacion: "2014"
  },
  {
    id: 7,
    titulo: "Centro de Tecnologías Educativas",
    descripcion: "Investigación y desarrollo de herramientas digitales para la educación y el aprendizaje virtual.",
    area: "EDUCACIÓN",
    estado: "EN DESARROLLO",
    director: "Dra. Carmen Jiménez",
    fundacion: "2021"
  },
  {
    id: 8,
    titulo: "Centro de Estudios Económicos y Financieros",
    descripcion: "Análisis económico, estudios de mercado y desarrollo de modelos financieros para el sector privado y público.",
    area: "ECONOMÍA",
    estado: "ACTIVO",
    director: "Dr. Miguel Torres",
    fundacion: "2013"
  }
];

const filtros = [
  { id: 'ALL', label: 'TODOS', active: true },
  { id: 'INGENIERÍA', label: 'INGENIERÍA', active: false },
  { id: 'CIENCIAS AMBIENTALES', label: 'CIENCIAS AMBIENTALES', active: false },
  { id: 'CIENCIAS SOCIALES', label: 'CIENCIAS SOCIALES', active: false },
  { id: 'INNOVACIÓN', label: 'INNOVACIÓN', active: false },
  { id: 'CIENCIAS DE LA SALUD', label: 'CIENCIAS DE LA SALUD', active: false },
  { id: 'ACTIVO', label: 'ACTIVOS', active: false },
  { id: 'EN DESARROLLO', label: 'EN DESARROLLO', active: false }
];
---

<Layout title={title}>
  <main class="main">
    <div class="container">
      <div class="page-content">
        <!-- Sidebar -->
        <aside class="sidebar">
          <div class="filter-list">
            {filtros.map((filtro) => (
              <button 
                class={`filter-btn ${filtro.active ? 'active' : ''}`}
                data-filter={filtro.id}
              >
                {filtro.label}
              </button>
            ))}
          </div>
        </aside>

        <!-- Main Content -->
        <section class="content">
          <header class="main-header">
            <h1 class="main-title">Centros de estudios</h1>
          </header>
          
          <header class="content-header">
            <h2 class="page-title">
              Unidades de <span class="highlight">investigación</span>
            </h2>
            <p class="page-description">
              Nuestros centros de estudios especializados desarrollan investigación de vanguardia 
              en diversas áreas del conocimiento, contribuyendo al avance científico y tecnológico del país.
            </p>
          </header>

          <div class="centros-container">
            {centros.map((centro, index) => (
              <article 
                class="centro-card lazy-load"
                data-area={centro.area}
                data-estado={centro.estado}
                style={`animation-delay: ${index * 0.1}s`}
              >
                <div class="centro-image">
                  <div class="placeholder-image">
                    <svg viewBox="0 0 100 80" class="image-icon">
                      <rect x="15" y="25" width="70" height="45" fill="none" stroke="#dc2626" stroke-width="2" rx="4"/>
                      <rect x="25" y="35" width="15" height="25" fill="#dc2626" opacity="0.3"/>
                      <rect x="45" y="30" width="15" height="30" fill="#dc2626" opacity="0.5"/>
                      <rect x="65" y="40" width="15" height="20" fill="#dc2626" opacity="0.7"/>
                      <circle cx="30" cy="20" r="3" fill="#dc2626"/>
                      <path d="M35 17 L40 22" stroke="#dc2626" stroke-width="1.5"/>
                    </svg>
                  </div>
                  <div class="estado-badge" data-estado={centro.estado}>
                    {centro.estado}
                  </div>
                </div>
                
                <div class="centro-content">
                  <div class="centro-header">
                    <h2 class="centro-titulo">{centro.titulo}</h2>
                    <span class="area-tag">{centro.area}</span>
                  </div>
                  
                  <p class="centro-descripcion">{centro.descripcion}</p>
                  
                  <div class="centro-info">
                    <div class="info-item">
                      <span class="info-label">Director:</span>
                      <span class="info-value">{centro.director}</span>
                    </div>
                    <div class="info-item">
                      <span class="info-label">Fundación:</span>
                      <span class="info-value">{centro.fundacion}</span>
                    </div>
                  </div>
                  
                  <div class="centro-actions">
                    <button class="btn-ver-info" data-centro-id={centro.id}>
                      VER DETALLES
                    </button>
                    <button class="btn-contactar" data-centro-id={centro.id}>
                      CONTACTAR
                    </button>
                  </div>
                </div>
              </article>
            ))}
          </div>
        </section>
      </div>
    </div>
  </main>
</Layout>

<style>
  /* Main layout */
  .main { padding: 4.5rem 0; min-height: calc(100vh - 200px); }
  .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
  .page-content { display: flex; gap: 3rem; align-items: flex-start; }

  /* Sidebar */
  .sidebar {
    width: 220px; flex-shrink: 0; background: #ffffff; border-radius: 12px;
    border: 1px solid #e5e7eb; padding: 2rem 1.5rem; position: sticky; top: 2rem;
box-shadow: 0 2px 6px rgba(0,0,0,0.05);
 margin-top:4rem;
  }
  .filter-list { display: flex; flex-direction: column; gap: 0.25rem; }
  .filter-btn {
    background: transparent; border: none; padding: 0.8rem 1.2rem;
    text-align: left; font-size: 0.75rem; color: #6b7280; cursor: pointer;
    font-weight: 600; border-radius: 6px; transition: all 0.3s ease; text-transform: uppercase;
  }
  .filter-btn.active { background: #fef2f2; color: #dc2626; font-weight: 700; }
  .filter-btn:hover { background: #f9fafb; transform: translateX(2px); }

  /* Content headers */
  .main-title { font-size: 2.5rem; font-weight: 700; color: #111827; margin-bottom: 1rem; }
  .page-title { font-size: 1.75rem; font-weight: 300; color: #1f2937; margin: 0 0 1rem 0; }
  .page-description { color: #6b7280; font-size: 1rem; max-width: 600px; }
  .highlight { color: #dc2626; font-weight: 500; }

  /* Centros container */
  .centros-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
  }

  .centro-card {
    display: flex; flex-direction: column; background: #fff;
    border-radius: 16px; overflow: hidden; border: 1px solid #f3f4f6;
    transition: transform 0.4s ease, box-shadow 0.4s ease;
    opacity: 0; transform: translateY(20px);
  }
  .centro-card.visible { opacity: 1; transform: translateY(0); transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
  .centro-card:hover { transform: translateY(-6px); box-shadow: 0 12px 30px rgba(0,0,0,0.12); border-color: #dc2626; }

  .centro-image {
    width: 100%; height: 160px; background: linear-gradient(135deg,#fef2f2,#fee2e2);
    display: flex; align-items: center; justify-content: center; position: relative;
  }
  .placeholder-image { width: 60px; height: 60px; }
  .estado-badge { position: absolute; top: 12px; right: 12px; padding: 0.35rem 0.75rem;
    font-size: 0.75rem; font-weight: 700; border-radius: 12px; text-transform: uppercase; }
  .estado-badge[data-estado="ACTIVO"] { background: #d1fae5; color: #065f46; }
  .estado-badge[data-estado="EN DESARROLLO"] { background: #fef3c7; color: #92400e; }

  .centro-content { padding: 1.8rem 1.5rem; display: flex; flex-direction: column; gap: 1rem; }
  .centro-header { display: flex; justify-content: space-between; align-items: flex-start; gap: 1rem; }
  .centro-titulo { font-size: 1.2rem; font-weight: 700; color: #111827; margin: 0 0 0.25rem 0; }
  .area-tag { background: #fee2e2; color: #b91c1c; padding: 0.25rem 0.6rem; border-radius: 9999px; font-size: 0.65rem; font-weight: 600; text-transform: uppercase; }

  .centro-descripcion { color: #4b5563; font-size: 0.95rem; line-height: 1.6; }
  .centro-info { display: flex; flex-wrap: wrap; gap: 1.5rem; margin-top: 0.5rem; }
  .info-item { display: flex; flex-direction: column; gap: 0.25rem; }
  .info-label { font-size: 0.7rem; font-weight: 600; color: #9ca3af; text-transform: uppercase; }
  .info-value { font-size: 0.85rem; font-weight: 500; color: #1f2937; }

  .centro-actions { display: flex; gap: 0.75rem; margin-top: auto; }
  .btn-ver-info { flex: 1; border: none; padding: 0.65rem 1.2rem; font-size: 0.8rem; font-weight: 600; border-radius: 8px; text-transform: uppercase; background: linear-gradient(90deg,#dc2626,#f87171); color: #fff; box-shadow: 0 4px 12px rgba(220,38,38,0.2); }
  .btn-ver-info:hover { background: linear-gradient(90deg,#b91c1c,#ef4444); }
  .btn-contactar { flex: 1; border: 1px solid #6b7280; padding: 0.65rem 1.2rem; font-size: 0.8rem; font-weight: 600; border-radius: 8px; text-transform: uppercase; color: #6b7280; }
  .btn-contactar:hover { background: #6b7280; color: white; }

  /* Hidden state for filtering */
  .centro-card.hidden { display: none; }

  /* Responsive */
  @media (max-width: 768px) {
    .page-content { flex-direction: column; gap: 2rem; }
    .sidebar { width: 100%; position: static; border-right: none; border-bottom: 1px solid #e5e7eb; padding: 1.5rem; }
    .filter-list { flex-direction: row; overflow-x: auto; gap: 0.5rem; padding-bottom: 0.5rem; }
    .filter-btn { white-space: nowrap; padding: 0.6rem 1rem; border-left: none; border-bottom: 3px solid transparent; }
    .filter-btn.active { border-bottom-color: #dc2626; }
    .main-title { font-size: 2rem; }
    .page-title { font-size: 1.5rem; }
  }

  /* Lazy loading animation */
  .lazy-load { animation: fadeInUp 0.6s ease forwards; }
  @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
</style>

<script>
  class CentrosManager {
    private centros: NodeListOf<HTMLElement>;
    private filterButtons: NodeListOf<HTMLButtonElement>;
    private observer: IntersectionObserver;

    constructor() {
      this.centros = document.querySelectorAll('.centro-card');
      this.filterButtons = document.querySelectorAll('.filter-btn');
      this.setupLazyLoading();
      this.setupFiltering();
      this.setupCentroButtons();
    }

    private setupLazyLoading() {
      const options = { root: null, rootMargin: '50px', threshold: 0.1 };
      this.observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const element = entry.target as HTMLElement;
            element.classList.add('visible');
            this.observer.unobserve(element);
          }
        });
      }, options);
      this.centros.forEach(centro => this.observer.observe(centro));
    }

    private setupFiltering() {
      this.filterButtons.forEach(button => {
        button.addEventListener('click', (e) => {
          const target = e.target as HTMLButtonElement;
          const filter = target.dataset.filter;
          this.filterButtons.forEach(btn => btn.classList.remove('active'));
          target.classList.add('active');
          this.filterCentros(filter);
        });
      });
    }

    private filterCentros(filter: string | undefined) {
      if (!filter) return;
      this.centros.forEach((centro) => {
        const area = centro.dataset.area;
        const estado = centro.dataset.estado;
        let shouldShow = filter === 'ALL' || filter === estado || filter === area;
        if (shouldShow) {
          centro.classList.remove('hidden');
          if (!centro.classList.contains('visible')) this.observer.observe(centro);
        } else { centro.classList.add('hidden'); }
      });
    }

    private setupCentroButtons() {
      document.querySelectorAll('.btn-ver-info').forEach(button => {
        button.addEventListener('click', (e) => {
          const centroId = (e.target as HTMLElement).dataset.centroId;
          alert(`Información detallada del centro ${centroId}`);
        });
      });
      document.querySelectorAll('.btn-contactar').forEach(button => {
        button.addEventListener('click', (e) => {
          const centroId = (e.target as HTMLElement).dataset.centroId;
          alert(`Contactar centro ${centroId}`);
        });
      });
    }
  }

  document.addEventListener('DOMContentLoaded', () => new CentrosManager());
</script>
