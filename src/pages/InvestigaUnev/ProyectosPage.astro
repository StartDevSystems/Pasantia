---
import Layout from '../../layouts/Layout.astro';
export interface Props {
  title?: string;
}

const { title = "Proyectos de investigación - INTEC" } = Astro.props;

const proyectos = [
  { id: 1, titulo: "Monitoreo y Caracterización de los Contaminantes Atmosféricos...", categoria: "ACTUALES", tipo: "FONDO EXTERNO" },
  { id: 2, titulo: "Evaluación De Alternativas De Valorización Energética...", categoria: "ACTUALES", tipo: "FONDO PROPIO" },
  { id: 3, titulo: "Análisis de riesgos objetivos y subjetivos asociados al cambio climático...", categoria: "ACTUALES", tipo: "FONDO EXTERNO" },
  { id: 4, titulo: "Desarrollo de Algoritmos de Machine Learning...", categoria: "CONCLUIDOS", tipo: "FONDO EXTERNO" },
  { id: 5, titulo: "Análisis de Vulnerabilidades en Sistemas de Telecomunicaciones...", categoria: "ACTUALES", tipo: "FONDO PROPIO" },
  { id: 6, titulo: "Estudio de Factibilidad para Implementación de Energía Solar...", categoria: "CONCLUIDOS", tipo: "FONDO EXTERNO" },
  { id: 7, titulo: "Investigación sobre Materiales Biodegradables...", categoria: "ACTUALES", tipo: "FONDO PROPIO" },
  { id: 8, titulo: "Desarrollo de Sistemas IoT para Monitoreo Ambiental...", categoria: "ACTUALES", tipo: "FONDO EXTERNO" },
  { id: 9, titulo: "Optimización de Procesos de Tratamiento de Aguas Residuales...", categoria: "CONCLUIDOS", tipo: "FONDO PROPIO" }
];

const filtros = [
  { id: 'ALL', label: 'ALL', active: true },
  { id: 'ACTUALES', label: 'ACTUALES', active: false },
  { id: 'CONCLUIDOS', label: 'CONCLUIDOS', active: false },
  { id: 'FONDO EXTERNO', label: 'FONDO EXTERNO', active: false },
  { id: 'FONDO PROPIO', label: 'FONDO PROPIO', active: false }
];
---

<Layout title={title}>
  <main class="main">
    <div class="container">
      <div class="page-content">
        <!-- Sidebar -->
        <aside class="sidebar">
          <div class="filter-list">
            {filtros.map((filtro) => (
              <button 
                class={`filter-btn ${filtro.active ? 'active' : ''}`}
                data-filter={filtro.id}
              >
                {filtro.label}
              </button>
            ))}
          </div>
        </aside>

        <!-- Main Content -->
        <section class="content">
          <header class="page-header">
            <h1 class="page-title">
              Proyectos de <span class="highlight">investigación</span>
            </h1>
          </header>

          <div class="proyectos-container">
            {proyectos.map((proyecto) => (
              <article 
                class="proyecto-card"
                data-categoria={proyecto.categoria}
                data-tipo={proyecto.tipo.replace(' ', '_')}
              >
                <div class="proyecto-image">
                  <svg viewBox="0 0 100 80"><rect x="10" y="20" width="80" height="50" fill="none" stroke="#ccc" stroke-width="2"/><circle cx="25" cy="35" r="5" fill="#ccc"/><path d="M15 55 L35 40 L50 50 L85 25" stroke="#ccc" stroke-width="2" fill="none"/></svg>
                </div>
                <div class="proyecto-content">
                  <h2 class="proyecto-titulo">{proyecto.titulo}</h2>
                  <a href="#" class="btn-ver-info" data-proyecto-id={proyecto.id}>
                    VER INFORMACIÓN
                  </a>
                </div>
              </article>
            ))}
          </div>
        </section>
      </div>
    </div>
  </main>
</Layout>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap');
  :root {
    --color-rojo-unev: #960201;
    --color-dorado-unev: #bc9201;
    --color-texto-principal: #212529;
    --color-texto-secundario: #5a5a5a;
    --color-texto-claro: #888; /* Un gris más claro para los filtros */
    --color-borde: #dee2e6;
    --color-fondo-claro: #f8f9fa;
    --font-principal: 'Lato', sans-serif;
  }

  .main { font-family: var(--font-principal); padding: 4.5rem 0; background-color: white; }
  .container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }
  .page-content { display: grid; grid-template-columns: 180px 1fr; gap: 2.5rem; } /* Aumentamos un poco el gap */
  .sidebar {
    border-right: 1px solid var(--color-borde); padding-right: 1.5rem;
    position: sticky; top: 100px; 
  }
  .filter-list { list-style: none; padding: 0; margin: 0; }
  
  /* --- AJUSTE FINO DEL SIDEBAR --- */
  .filter-btn {
    background: transparent; border: none; width: 100%; text-align: left;
    padding: 0.8rem 0; /* Un poco más de aire entre filtros */
    font-size: 0.8rem;
    color: var(--color-texto-claro); /* Usamos el gris claro de Intec */
    cursor: pointer; font-weight: 400; text-transform: uppercase;
    position: relative; transition: color 0.2s ease;
  }
  .filter-btn::after {
    content: ''; position: absolute; right: -1.5rem; top: 50%;
    transform: translateY(-50%) scaleY(0);
    width: 3px; height: 24px; transition: all 0.2s ease;
  }
  .filter-btn:hover:not(.active)::after { background-color: #ccc; transform: translateY(-50%) scaleY(1); }
  .filter-btn.active::after { background-color: var(--color-rojo-unev); transform: translateY(-50%) scaleY(1); }
  .filter-btn:hover { color: var(--color-texto-principal); }
  .filter-btn.active { color: var(--color-rojo-unev); font-weight: 700; }
  
  .content { min-width: 0; }
  
  /* --- AJUSTE FINO DEL TÍTULO PRINCIPAL --- */
  .page-header { margin-bottom: 2rem; }
  .page-title {
    font-size: 2rem; font-weight: 300; /* Texto "Proyectos de" más fino */
    color: var(--color-texto-principal);
    margin: 0; position: relative; padding-left: 1.25rem; 
  }
  .page-title::before { /* La barra gris más fina y mejor alineada */
    content: ''; position: absolute; left: 0; top: 5px; bottom: 5px;
    width: 5px; background-color: #e0e0e0;
  }
  .page-title .highlight { color: var(--color-rojo-unev); font-weight: 700; /* Texto "investigación" más grueso */ }
  
  .proyectos-container { display: flex; flex-direction: column; gap: 1.5rem; }
  .proyecto-card {
    display: flex; gap: 1.5rem; background: white; border-bottom: 1px solid var(--color-borde);
    padding: 1.5rem 0; align-items: center;
  }
  .proyecto-image {
    width: 100px; height: 100px; flex-shrink: 0; display: flex;
    align-items: center; justify-content: center; background: var(--color-fondo-claro);
  }
  .proyecto-image svg { width: 40px; height: 40px; }
  .proyecto-content { flex-grow: 1; }
  .proyecto-titulo { font-size: 1rem; font-weight: 500; color: var(--color-texto-principal); line-height: 1.6; margin: 0 0 1rem 0; }
  .btn-ver-info {
    background: white; border: 1px solid var(--color-borde); color: var(--color-texto-secundario);
    font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;
    cursor: pointer; padding: 0.6rem 1.2rem; border-radius: 50px;
    transition: all 0.3s ease; text-decoration: none; display: inline-block;
  }
  .btn-ver-info:hover {
    background: var(--color-fondo-claro); color: var(--color-rojo-unev);
    border-color: #ccc; box-shadow: 0 2px 8px rgba(0,0,0,0.07);
  }

  .proyecto-card.hidden { display: none; }
  @media (max-width: 768px) { .page-content { grid-template-columns: 1fr; } .sidebar { border-right: none; border-bottom: 1px solid var(--color-borde); padding-right: 0; padding-bottom: 1.5rem; position: static; } .filter-list { display: flex; overflow-x: auto; gap: 1.5rem; padding-bottom: 0.5rem;} .filter-btn { white-space: nowrap; } .filter-btn::after { display: none; } }
</style>

<script>
  class ProyectosManager {
    constructor() {
      this.proyectos = document.querySelectorAll('.proyecto-card'); this.filterButtons = document.querySelectorAll('.filter-btn'); this.setupFiltering();
    }
    setupFiltering() {
      this.filterButtons.forEach(button => {
        button.addEventListener('click', (e) => {
          const target = e.currentTarget; const filter = target.dataset.filter;
          this.filterButtons.forEach(btn => btn.classList.remove('active'));
          target.classList.add('active'); this.filterProjects(filter);
        });
      });
    }
    filterProjects(filter) {
      if (!filter) return;
      this.proyectos.forEach((proyecto) => {
        const categoria = proyecto.dataset.categoria; const tipo = proyecto.dataset.tipo;
        let shouldShow = false;
        switch (filter) {
          case 'ALL': shouldShow = true; break;
          case 'ACTUALES': shouldShow = categoria === 'ACTUALES'; break;
          case 'CONCLUIDOS': shouldShow = categoria === 'CONCLUIDOS'; break;
          case 'FONDO EXTERNO': shouldShow = tipo === 'FONDO_EXTERNO'; break;
          case 'FONDO PROPIO': shouldShow = tipo === 'FONDO_PROPIO'; break;
        }
        proyecto.classList.toggle('hidden', !shouldShow);
      });
    }
  }
  document.addEventListener('DOMContentLoaded', () => { new ProyectosManager(); });
</script>